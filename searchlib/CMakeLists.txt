# Copyright 2017 Yahoo Holdings. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.
vespa_define_module(
    DEPENDS
    fastos
    vespalog
    vespalib
    staging_vespalib
    vespaeval
    fnet
    configdefinitions
    metrics
    fastlib_fast
    document
    config_cloudconfig
    persistencetypes
    searchcommon

    EXTERNAL_DEPENDS
    rt

    LIBS
    src/vespa/searchlib
    src/vespa/searchlib/aggregation
    src/vespa/searchlib/attribute
    src/vespa/searchlib/bitcompression
    src/vespa/searchlib/btree
    src/vespa/searchlib/common
    src/vespa/searchlib/config
    src/vespa/searchlib/datastore
    src/vespa/searchlib/diskindex
    src/vespa/searchlib/docstore
    src/vespa/searchlib/engine
    src/vespa/searchlib/expression
    src/vespa/searchlib/features
    src/vespa/searchlib/features/fieldmatch
    src/vespa/searchlib/features/rankingexpression
    src/vespa/searchlib/fef
    src/vespa/searchlib/fef/test
    src/vespa/searchlib/fef/test/plugin
    src/vespa/searchlib/grouping
    src/vespa/searchlib/index
    src/vespa/searchlib/memoryindex
    src/vespa/searchlib/parsequery
    src/vespa/searchlib/predicate
    src/vespa/searchlib/query
    src/vespa/searchlib/query/tree
    src/vespa/searchlib/queryeval
    src/vespa/searchlib/queryeval/test
    src/vespa/searchlib/queryeval/wand
    src/vespa/searchlib/tensor
    src/vespa/searchlib/test
    src/vespa/searchlib/test/diskindex
    src/vespa/searchlib/test/fakedata
    src/vespa/searchlib/test/memoryindex
    src/vespa/searchlib/transactionlog
    src/vespa/searchlib/uca
    src/vespa/searchlib/util

    APPS
    src/apps/docstore
    src/apps/tests
    src/apps/uniform
    src/apps/vespa-attribute-inspect
    src/apps/vespa-fileheader-inspect
    src/apps/vespa-index-inspect
    src/apps/vespa-ranking-expression-analyzer

    TESTS
    src/tests/aggregator
    src/tests/alignment
    src/tests/attribute
    src/tests/attribute/attributefilewriter
    src/tests/attribute/attributemanager
    src/tests/attribute/benchmark
    src/tests/attribute/bitvector
    src/tests/attribute/bitvector_search_cache
    src/tests/attribute/changevector
    src/tests/attribute/compaction
    src/tests/attribute/comparator
    src/tests/attribute/document_weight_iterator
    src/tests/attribute/enumeratedsave
    src/tests/attribute/enumstore
    src/tests/attribute/extendattributes
    src/tests/attribute/guard
    src/tests/attribute/imported_attribute_vector
    src/tests/attribute/imported_search_context
    src/tests/attribute/multi_value_mapping
    src/tests/attribute/posting_list_merger
    src/tests/attribute/postinglist
    src/tests/attribute/postinglistattribute
    src/tests/attribute/reference_attribute
    src/tests/attribute/searchable
    src/tests/attribute/searchcontext
    src/tests/attribute/sourceselector
    src/tests/attribute/stringattribute
    src/tests/attribute/tensorattribute
    src/tests/bitcompression/expgolomb
    src/tests/bitvector
    src/tests/btree
    src/tests/bytecomplens
    src/tests/common/bitvector
    src/tests/common/foregroundtaskexecutor
    src/tests/common/location
    src/tests/common/packets
    src/tests/common/rcuvector
    src/tests/common/resultset
    src/tests/common/sequencedtaskexecutor
    src/tests/common/summaryfeatures
    src/tests/datastore/array_store
    src/tests/datastore/array_store_config
    src/tests/datastore/buffer_type
    src/tests/datastore/datastore
    src/tests/datastore/unique_store
    src/tests/diskindex/bitvector
    src/tests/diskindex/diskindex
    src/tests/diskindex/fieldwriter
    src/tests/diskindex/fusion
    src/tests/diskindex/pagedict4
    src/tests/docstore/chunk
    src/tests/docstore/document_store
    src/tests/docstore/document_store_visitor
    src/tests/docstore/file_chunk
    src/tests/docstore/lid_info
    src/tests/docstore/logdatastore
    src/tests/docstore/store_by_bucket
    src/tests/engine/docsumapi
    src/tests/engine/monitorapi
    src/tests/engine/searchapi
    src/tests/engine/transportserver
    src/tests/features
    src/tests/features/beta
    src/tests/features/constant
    src/tests/features/element_completeness
    src/tests/features/element_similarity_feature
    src/tests/features/euclidean_distance
    src/tests/features/imported_dot_product
    src/tests/features/internal_max_reduce_prod_join_feature
    src/tests/features/item_raw_score
    src/tests/features/max_reduce_prod_join_replacer
    src/tests/features/native_dot_product
    src/tests/features/ranking_expression
    src/tests/features/raw_score
    src/tests/features/subqueries
    src/tests/features/tensor
    src/tests/features/tensor_from_labels
    src/tests/features/tensor_from_weighted_set
    src/tests/features/text_similarity_feature
    src/tests/features/util
    src/tests/fef
    src/tests/fef/attributecontent
    src/tests/fef/featurenamebuilder
    src/tests/fef/featurenameparser
    src/tests/fef/featureoverride
    src/tests/fef/object_passing
    src/tests/fef/parameter
    src/tests/fef/phrasesplitter
    src/tests/fef/properties
    src/tests/fef/rank_program
    src/tests/fef/resolver
    src/tests/fef/table
    src/tests/fef/termfieldmodel
    src/tests/fef/termmatchdatamerger
    src/tests/fileheadertk
    src/tests/forcelink
    src/tests/grouping
    src/tests/groupingengine
    src/tests/hitcollector
    src/tests/index/docbuilder
    src/tests/index/doctypebuilder
    src/tests/indexmetainfo
    src/tests/ld-library-path
    src/tests/memoryindex/compact_document_words_store
    src/tests/memoryindex/datastore
    src/tests/memoryindex/dictionary
    src/tests/memoryindex/document_remover
    src/tests/memoryindex/documentinverter
    src/tests/memoryindex/fieldinverter
    src/tests/memoryindex/memoryindex
    src/tests/memoryindex/urlfieldinverter
    src/tests/nativerank
    src/tests/nearsearch
    src/tests/postinglistbm
    src/tests/predicate
    src/tests/prettyfloat
    src/tests/query
    src/tests/queryeval
    src/tests/queryeval/blueprint
    src/tests/queryeval/booleanmatchiteratorwrapper
    src/tests/queryeval/dot_product
    src/tests/queryeval/equiv
    src/tests/queryeval/fake_searchable
    src/tests/queryeval/getnodeweight
    src/tests/queryeval/monitoring_search_iterator
    src/tests/queryeval/multibitvectoriterator
    src/tests/queryeval/parallel_weak_and
    src/tests/queryeval/predicate
    src/tests/queryeval/simple_phrase
    src/tests/queryeval/sourceblender
    src/tests/queryeval/sparse_vector_benchmark
    src/tests/queryeval/termwise_eval
    src/tests/queryeval/weak_and
    src/tests/queryeval/weak_and_heap
    src/tests/queryeval/weak_and_scorers
    src/tests/queryeval/weighted_set_term
    src/tests/rankingexpression/feature_name_extractor
    src/tests/rankingexpression/intrinsic_blueprint_adapter
    src/tests/ranksetup
    src/tests/ranksetup/verify_feature
    src/tests/sort
    src/tests/sortresults
    src/tests/sortspec
    src/tests/stackdumpiterator
    src/tests/stringenum
    src/tests/tensor/dense_tensor_store
    src/tests/transactionlog
    src/tests/transactionlogstress
    src/tests/true
    src/tests/url
    src/tests/util
    src/tests/util/bufferwriter
    src/tests/util/ioerrorhandler
    src/tests/util/searchable_stats
    src/tests/util/sigbushandler
    src/tests/util/slime_output_raw_buf_adapter
    src/tests/util/statebuf
    src/tests/util/statefile
    src/tests/vespa-fileheader-inspect
)

install_java_artifact(searchlib)
install_fat_java_artifact(searchlib)

vespa_install_script(src/main/sh/vespa-gbdt-converter bin)
vespa_install_script(src/main/sh/vespa-treenet-converter bin)

